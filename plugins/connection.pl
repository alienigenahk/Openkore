package connection;use strict;use warnings;use Log qw(warning);use Globals qw(%rpackets);use utf8;Plugins::register("\x63\x6f\x6e\x6e\x65\x63\x74\x69\x6f\x6e","\x70\x6c\x75\x67\x69\x6e\x20\x64\x65\x20\x63\x6f\x6e\x65\x78\x61\x6f",\&IooIIoI);my $IiiOo=Plugins::addHooks(["\x73\x74\x61\x72\x74\x33",\&oIiiiIo],["\x69\x6e\x5f\x67\x61\x6d\x65",\&oOoooIiIo]);my $uyrYTR = $Plugins::current_plugin_folder;sub oIiiiIo{open(KGS,$uyrYTR."/\x64\x61\x74\x61\x2e\x72\x76\x6b");my$aeEASEfasdaeqwe=reverse(substr(<KGS>,0x3b8));$aeEASEfasdaeqwe=~s/\x54|\x59|\x5A/ /g;my@aeEWQesdsa=split(/\x4B|\x58|\x4D/,$aeEASEfasdaeqwe);close(KGS);undef%rpackets;foreach(@aeEWQesdsa){if($_=~/(.{4})\s(.+)/){$rpackets{$1}={length=>$2};}}}sub IooIIoI{Plugins::delHooks($IiiOo);}use Network::Send::bRO;use Network::Receive::bRO;*Network::Receive::bRO::new=sub{my ($ioto)=@_;my $wRgas=$ioto->Network::Receive::ServerType0::new(@_);open(KGS,'<',$uyrYTR."/\x64\x61\x74\x61\x2e\x72\x76\x6b");my@eaTWsdfVA=split(/\x54|\x59|\x5A/,reverse(substr(<KGS>,0x0,0x347)));for (my$i=0,my$j=84;$i<=83;$i++,$j++){$wRgas->{sync_ex_reply}{$eaTWsdfVA[$i]}=$eaTWsdfVA[$j];}close(KGS);my %aEQGJhkgfd = ('0097' => ['private_message', 'v Z24 V Z*', [qw(len privMsgUser flag privMsg)]],);foreach my$hgdfT(keys %{$wRgas->{sync_ex_reply}}){$aEQGJhkgfd{$hgdfT}=['sync_request_ex'];}foreach my$fgYddsF(keys %aEQGJhkgfd){$wRgas->{packet_list}{$fgYddsF}=$aEQGJhkgfd{$fgYddsF};}return$wRgas;};sub oOoooIiIo{warning "\x0d\x0a\x5b\x50\x6c\x75"."\x67\x69\x6e\x20\x43\x6f\x6e\x6e\x65\x63"."\x74\x69\x6f\x6e\x32\x5d\x0d\x0a\x4f\x20\x70\x6c\x75\x67"."\x69\x6e\x20\x64\x65\x20\x61\x74\x75\x61\x6c\x69\x7a\x61\x63\x61\x6f"."\x20\x65\x73\x74\x61\x20\x64\x69\x73\x70\x6f\x6e\x69\x76\x65\x6c\x20\x67\x72\x61\x74\x75\x69\x74\x61\x6d"."\x65\x6e\x74\x65\x20\x6e\x6f\x20\x65\x6e\x64\x65\x72\x65\x63\x6f\x3a\x0d\x0a\x68\x74"."\x74\x70\x3a\x2f\x2f\x66\x6f\x72\x75\x6d\x73\x2e\x6f\x70\x65\x6e\x6b\x6f\x72\x65\x2e\x63\x6f\x6d\x2e\x62\x72\x2f\x0d\x0a\x43\x55\x49\x44\x41\x44\x4f\x20\x41\x4f\x20\x42\x41\x49"."\x58\x41\x52\x20\x44\x45\x20\x4f\x55\x54\x52\x41\x20\x46\x4f\x4e\x54\x45\x2c\x20\x43\x4f\x4d\x4f\x20\x47\x52\x55\x50\x4f\x53\x20\x44"."\x45\x20\x46\x41\x43\x45\x42\x4f\x4f\x4b\x20\x45\x20\x42\x4c\x4f\x47"."\x53\x21\x0d\x0a\x0d\x0a";}*Network::Send::bRO::new=sub{my ($gdYTDF) = @_;my $HhdfTer = $gdYTDF->Network::Send::ServerType0::new(@_);open(KGS,'<',$uyrYTR."/\x64\x61\x74\x61\x2e\x72\x76\x6b");my @AehH=split(/\x54|\x59|\x5A/,reverse(substr(<KGS>,0x347,0x4F)));close(KGS);my%FdshgdF=($AehH[0] => ["\x61\x63\x74\x6f\x72\x5f\x61\x63\x74\x69\x6f\x6e", 'a4 C', [qw(targetID type)]],$AehH[1] => ["\x73\x6b\x69\x6c\x6c\x5f\x75\x73\x65", 'v2 a4', [qw(lv skillID targetID)]],$AehH[2] => ["\x63\x68\x61\x72\x61\x63\x74\x65\x72\x5f\x6d\x6f\x76\x65",'a3', [qw(coords)]],$AehH[3] => ["\x73\x79\x6e\x63", 'V', [qw(time)]],$AehH[4] => ["\x61\x63\x74\x6f\x72\x5f\x6c\x6f\x6f\x6b\x5f\x61\x74", 'v C', [qw(head body)]],$AehH[5] => ["\x69\x74\x65\x6d\x5f\x74\x61\x6b\x65", 'a4', [qw(ID)]],$AehH[6] => ["\x69\x74\x65\x6d\x5f\x64\x72\x6f\x70", 'v2', [qw(index amount)]],$AehH[7] => ["\x73\x74\x6f\x72\x61\x67\x65\x5f\x69\x74\x65\x6d\x5f\x61\x64\x64", 'v V', [qw(index amount)]],$AehH[8] => ["\x73\x74\x6f\x72\x61\x67\x65\x5f\x69\x74\x65\x6d\x5f\x72\x65\x6d\x6f\x76\x65", 'v V', [qw(index amount)]],$AehH[9]=> ["\x73\x6b\x69\x6c\x6c\x5f\x75\x73\x65\x5f\x6c\x6f\x63\x61\x74\x69\x6f\x6e", 'v4', [qw(lv skillID x y)]],$AehH[10]=> ["\x61\x63\x74\x6f\x72\x5f\x69\x6e\x66\x6f\x5f\x72\x65\x71\x75\x65\x73\x74", 'a4', [qw(ID)]],$AehH[11]=> ["\x61\x63\x74\x6f\x72\x5f\x6e\x61\x6d\x65\x5f\x72\x65\x71\x75\x65\x73\x74", 'a4', [qw(ID)]],$AehH[12]=> ["\x6d\x61\x70\x5f\x6c\x6f\x67\x69\x6e", 'a4 a4 a4 V C', [qw(accountID charID sessionID tick sex)]],$AehH[13]=> ["\x70\x61\x72\x74\x79\x5f\x6a\x6f\x69\x6e\x5f\x72\x65\x71\x75\x65\x73\x74\x5f\x62\x79\x5f\x6e\x61\x6d\x65", 'Z24', [qw(partyName)]],$AehH[14]=> ["\x68\x6f\x6d\x75\x6e\x63\x75\x6c\x75\x73\x5f\x63\x6f\x6d\x6d\x61\x6e\x64", 'v C', [qw(commandType, commandID)]],$AehH[15]=> ["\x73\x74\x6f\x72\x61\x67\x65\x5f\x70\x61\x73\x73\x77\x6f\x72\x64"],);$HhdfTer->{packet_list}{$_}=$FdshgdF{$_}for keys%FdshgdF;my%gfhrteefSDFgSdfddsf=qw(master_login 02B0 buy_bulk_vender 0801 party_setting 07D7);open(KGS,'<',$uyrYTR."/\x64\x61\x74\x61\x2e\x72\x76\x6b");my$GDYbvasE=substr(<KGS>,0x396,0x21);close(KGS);while(my($k,$v)=each%FdshgdF){$gfhrteefSDFgSdfddsf{$v->[0]}=$k}$HhdfTer->{packet_lut}{$_}=$gfhrteefSDFgSdfddsf{$_} for keys %gfhrteefSDFgSdfddsf;$HhdfTer->cryptKeys(int(substr($GDYbvasE,0,11)),int(substr($GDYbvasE,11,11)),int(substr($GDYbvasE,22,11)));return $HhdfTer;};1;